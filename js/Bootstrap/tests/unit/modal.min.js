$(function(){QUnit.module("modal plugin");QUnit.test("should be defined on jquery object",function(a){a.expect(1);a.ok($(document.body).modal,"modal method is defined")});QUnit.module("modal",{beforeEach:function(){$.fn.bootstrapModal=$.fn.modal.noConflict()},afterEach:function(){$.fn.modal=$.fn.bootstrapModal;delete $.fn.bootstrapModal}});QUnit.test("should provide no conflict",function(a){a.expect(1);a.strictEqual($.fn.modal,undefined,"modal was set back to undefined (orig value)")});QUnit.test("should return jquery collection containing the element",function(a){a.expect(2);var c=$('<div id="modal-test"/>');var b=c.bootstrapModal();a.ok(b instanceof $,"returns jquery collection");a.strictEqual(b[0],c[0],"collection contains element")});QUnit.test("should expose defaults var for settings",function(a){a.expect(1);a.ok($.fn.bootstrapModal.Constructor.DEFAULTS,"default object exposed")});QUnit.test("should insert into dom when show method is called",function(b){b.expect(1);var a=b.async();$('<div id="modal-test"/>').on("shown.bs.modal",function(){b.notEqual($("#modal-test").length,0,"modal inserted into dom");a()}).bootstrapModal("show")});QUnit.test("should fire show event",function(b){b.expect(1);var a=b.async();$('<div id="modal-test"/>').on("show.bs.modal",function(){b.ok(true,"show event fired");a()}).bootstrapModal("show")});QUnit.test("should not fire shown when show was prevented",function(b){b.expect(1);var a=b.async();$('<div id="modal-test"/>').on("show.bs.modal",function(c){c.preventDefault();b.ok(true,"show event fired");a()}).on("shown.bs.modal",function(){b.ok(false,"shown event fired")}).bootstrapModal("show")});QUnit.test("should hide modal when hide is called",function(b){b.expect(3);var a=b.async();$('<div id="modal-test"/>').on("shown.bs.modal",function(){b.ok($("#modal-test").is(":visible"),"modal visible");b.notEqual($("#modal-test").length,0,"modal inserted into dom");$(this).bootstrapModal("hide")}).on("hidden.bs.modal",function(){b.ok(!$("#modal-test").is(":visible"),"modal hidden");a()}).bootstrapModal("show")});QUnit.test("should toggle when toggle is called",function(b){b.expect(3);var a=b.async();$('<div id="modal-test"/>').on("shown.bs.modal",function(){b.ok($("#modal-test").is(":visible"),"modal visible");b.notEqual($("#modal-test").length,0,"modal inserted into dom");$(this).bootstrapModal("toggle")}).on("hidden.bs.modal",function(){b.ok(!$("#modal-test").is(":visible"),"modal hidden");a()}).bootstrapModal("toggle")});QUnit.test('should remove from dom when click [data-dismiss="modal"]',function(b){b.expect(3);var a=b.async();$('<div id="modal-test"><span class="close" data-dismiss="modal"/></div>').on("shown.bs.modal",function(){b.ok($("#modal-test").is(":visible"),"modal visible");b.notEqual($("#modal-test").length,0,"modal inserted into dom");$(this).find(".close").trigger("click")}).on("hidden.bs.modal",function(){b.ok(!$("#modal-test").is(":visible"),"modal hidden");a()}).bootstrapModal("toggle")});QUnit.test('should allow modal close with "backdrop:false"',function(b){b.expect(2);var a=b.async();$('<div id="modal-test" data-backdrop="false"/>').on("shown.bs.modal",function(){b.ok($("#modal-test").is(":visible"),"modal visible");$(this).bootstrapModal("hide")}).on("hidden.bs.modal",function(){b.ok(!$("#modal-test").is(":visible"),"modal hidden");a()}).bootstrapModal("show")});QUnit.test("should close modal when clicking outside of modal-content",function(b){b.expect(3);var a=b.async();$('<div id="modal-test"><div class="contents"/></div>').on("shown.bs.modal",function(){b.notEqual($("#modal-test").length,0,"modal inserted into dom");$(".contents").trigger("click");b.ok($("#modal-test").is(":visible"),"modal visible");$("#modal-test").trigger("click")}).on("hidden.bs.modal",function(){b.ok(!$("#modal-test").is(":visible"),"modal hidden");a()}).bootstrapModal("show")});QUnit.test("should close modal when escape key is pressed via keydown",function(c){c.expect(3);var b=c.async();var a=$('<div id="modal-test"/>');a.on("shown.bs.modal",function(){c.ok($("#modal-test").length,"modal inserted into dom");c.ok($("#modal-test").is(":visible"),"modal visible");a.trigger($.Event("keydown",{which:27}));setTimeout(function(){c.ok(!$("#modal-test").is(":visible"),"modal hidden");a.remove();b()},0)}).bootstrapModal("show")});QUnit.test("should not close modal when escape key is pressed via keyup",function(c){c.expect(3);var b=c.async();var a=$('<div id="modal-test"/>');a.on("shown.bs.modal",function(){c.ok($("#modal-test").length,"modal inserted into dom");c.ok($("#modal-test").is(":visible"),"modal visible");a.trigger($.Event("keyup",{which:27}));setTimeout(function(){c.ok(a.is(":visible"),"modal still visible");a.remove();b()},0)}).bootstrapModal("show")});QUnit.test("should trigger hide event once when clicking outside of modal-content",function(c){c.expect(1);var b=c.async();var a;$('<div id="modal-test"><div class="contents"/></div>').on("shown.bs.modal",function(){a=0;$("#modal-test").trigger("click")}).on("hide.bs.modal",function(){a+=1;c.strictEqual(a,1,"modal hide triggered once");b()}).bootstrapModal("show")});QUnit.test('should close reopened modal with [data-dismiss="modal"] click',function(b){b.expect(2);var a=b.async();$('<div id="modal-test"><div class="contents"><div id="close" data-dismiss="modal"/></div></div>').one("shown.bs.modal",function(){$("#close").trigger("click")}).one("hidden.bs.modal",function(){b.ok(!$("#modal-test").is(":visible"),"modal hidden");$(this).one("shown.bs.modal",function(){$("#close").trigger("click")}).one("hidden.bs.modal",function(){b.ok(!$("#modal-test").is(":visible"),"modal hidden");a()}).bootstrapModal("show")}).bootstrapModal("show")});QUnit.test("should restore focus to toggling element when modal is hidden after having been opened via data-api",function(b){b.expect(1);var a=b.async();var c=$('<button data-toggle="modal" data-target="#modal-test"/>').appendTo("#qunit-fixture");$('<div id="modal-test"><div class="contents"><div id="close" data-dismiss="modal"/></div></div>').on("hidden.bs.modal",function(){setTimeout(function(){b.ok($(document.activeElement).is(c),"toggling element is once again focused");a()},0)}).on("shown.bs.modal",function(){$("#close").trigger("click")}).appendTo("#qunit-fixture");c.trigger("click")});QUnit.test("should not restore focus to toggling element if the associated show event gets prevented",function(b){b.expect(1);var a=b.async();var c=$('<button data-toggle="modal" data-target="#modal-test"/>').appendTo("#qunit-fixture");var d=$('<button id="other-btn"/>').appendTo("#qunit-fixture");$('<div id="modal-test"><div class="contents"><div id="close" data-dismiss="modal"/></div>').one("show.bs.modal",function(f){f.preventDefault();d.trigger("focus");setTimeout($.proxy(function(){$(this).bootstrapModal("show")},this),0)}).on("hidden.bs.modal",function(){setTimeout(function(){b.ok($(document.activeElement).is(d),"focus returned to toggling element");a()},0)}).on("shown.bs.modal",function(){$("#close").trigger("click")}).appendTo("#qunit-fixture");c.trigger("click")});QUnit.test("should restore inline body padding after closing",function(b){b.expect(2);var a=b.async();var d=0;var c=$(document.body);c.css("padding-right",d);$('<div id="modal-test"/>').on("hidden.bs.modal",function(){var e=parseInt(c.css("padding-right"),10);b.notStrictEqual(c.attr("style"),"","body has non-empty style attribute");b.strictEqual(e,d,"original body padding was not changed");c.removeAttr("style");a()}).on("shown.bs.modal",function(){$(this).bootstrapModal("hide")}).bootstrapModal("show")});QUnit.test("should ignore values set via CSS when trying to restore body padding after closing",function(b){b.expect(1);var a=b.async();var d=$(document.body);var c=$("<style>body { padding-right: 42px; }</style>").appendTo("head");$('<div id="modal-test"/>').on("hidden.bs.modal",function(){b.ok(!d.attr("style"),"body does not have inline padding set");c.remove();a()}).on("shown.bs.modal",function(){$(this).bootstrapModal("hide")}).bootstrapModal("show")});QUnit.test("should ignore other inline styles when trying to restore body padding after closing",function(b){b.expect(2);var a=b.async();var d=$(document.body);var c=$("<style>body { padding-right: 42px; }</style>").appendTo("head");d.css("color","red");$('<div id="modal-test"/>').on("hidden.bs.modal",function(){b.strictEqual(d[0].style.paddingRight,"","body does not have inline padding set");b.strictEqual(d[0].style.color,"red","body still has other inline styles set");d.removeAttr("style");c.remove();a()}).on("shown.bs.modal",function(){$(this).bootstrapModal("hide")}).bootstrapModal("show")});QUnit.test("should properly restore non-pixel inline body padding after closing",function(b){b.expect(1);var a=b.async();var c=$(document.body);c.css("padding-right","5%");$('<div id="modal-test"/>').on("hidden.bs.modal",function(){b.strictEqual(c[0].style.paddingRight,"5%","body does not have inline padding set");c.removeAttr("style");a()}).on("shown.bs.modal",function(){$(this).bootstrapModal("hide")}).bootstrapModal("show")})});